# Load libraries
library(tidyverse)
gpd_2122 <- read_csv("data/UK Gender Pay Gap Data - 2021 to 2022.csv")
gpd_2021 <- read_csv("data/UK Gender Pay Gap Data - 2020 to 2021.csv")
uni <- read_csv("data/universities.csv")
gpd_2122 <- read_csv("data/UK Gender Pay Gap Data - 2021 to 2022.csv")
gpd_2021 <- read_csv("data/UK Gender Pay Gap Data - 2020 to 2021.csv")
uni <- read_csv("data/universities.csv")
glimpse(gpd_2122)
glimpse(gpd_2021)
glimpse(uni)
gpd <- rbind(gpd_2122, gpd_2021)
glipse(gpd)
glimpse(gpd)
# Join the universities data. Use inner join to drop any rows not in Uni
gpd_uni <- inner_join(gpd, uni, by =c("EmployerID"))
# Join the universities data. Use inner join to drop any rows not in Uni
gpd_uni <- inner_join(gpd, uni, by =c("EmployerId"))
head(gpd_uni)
colnames(gpd_uni)
isTRUE(nrow(gpd_uni) == nrow(uni) * 2)
gpd_2122 <- read_csv("data/UK Gender Pay Gap Data - 2021 to 2022.csv")
gpd_2021 <- read_csv("data/UK Gender Pay Gap Data - 2020 to 2021.csv")
gpd_1920 <- read_csv("data/UK Gender Pay Gap Data - 2019 to 2020.csv")
gpd_1819 <- read_csv("data/UK Gender Pay Gap Data - 2018 to 2019.csv")
gpd_1718 <- read_csv("data/UK Gender Pay Gap Data - 2017 to 2018.csv")
uni <- read_csv("data/universities.csv")
gpd <- rbind(gpd_2122, gpd_2021)
# Join the universities data. Use inner join to drop any rows not in Uni
gpd_uni <- inner_join(gpd, uni, by =c("EmployerId"))
# Check rows in result
isTRUE(nrow(gpd_uni) == nrow(uni) * 2)
# Combine gpd
gpd <- rbind(gpd_2122, gpd_2021, gpd_1920, gpd_1819, gpd_1718)
# Join the universities data. Use inner join to drop any rows not in Uni
gpd_uni <- inner_join(gpd, uni, by =c("EmployerId"))
unique(gpd_uni["DueDate"])
unique(gpd_2122["DueDate"])
gpd_uni <- gpd_uni %>%
mutate(AssmntYr = str_sub(DueDate, 1, 4))
gpd_uni[AssmntYr]
View(gpd_1819)
gpd_uni %>%
group_by("pre92", "AssmntYr")
gpd_uni %>%
group_by("pre92", "AssmntYr") %>%
summarise(unicnt = nrow(EmployerName.x))
gpd_uni %>%
group_by("pre92", "AssmntYr") %>%
summarise(unicnt = count(EmployerName.x))
gpd_uni %>%
group_by("pre92", "AssmntYr") %>%
summarise(unicnt = tally())
gpd_uni %>%
group_by("pre92", "AssmntYr") %>%
summarise(unicnt = unicnt())
gpd_uni %>%
group_by("pre92", "AssmntYr") %>%
summarise(n = n())
gpd_uni %>%
count("pre92", "AssmntYr")
gpd_uni %>%
count("pre92")
head(gpd_uni)
head(gpd_uni)
gpd_uni %>%
group_by(pre92, AssmntYr) %>%
summarise(n = n())
gpd_uni %>%
group_by(AssmntYr, pre92) %>%
summarise("UniCount" = n())
?arrange
gpd_uni %>%
group_by(AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(desc(AssmntYr))
gpd_uni %>%
group_by(AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(desc(AssmntYr), desc(pre92))
# Contingency Table - how many universities have provided data each year, for
# both ‘pre-92’ and ‘post-92’ institutions
gpd_cont -> gpd_uni %>%
group_by(AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(desc(AssmntYr), desc(pre92))
# Contingency Table - how many universities have provided data each year, for
# both ‘pre-92’ and ‘post-92’ institutions
gpd_cont <- gpd_uni %>%
group_by(AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(desc(AssmntYr), desc(pre92))
head(gpd_cont)
gpd_uni %>%
group_by(EmployerName.x, AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.x, desc(AssmntYr), desc(pre92))
gpd_uni %>%
group_by(EmployerName.x, AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr), desc(pre92))
gpd_uni %>%
group_by(EmployerName.y, AssmntYr, pre92) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr), desc(pre92))
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr))
print(gpd_uni[EmployerName.y, AssmntYr], n = 60)
pivot_wider(gpd_uni,
names_from = AssmntYr,
values_from = EmployerName.x)
pivot_wider(gpd_uni[AssmntYr, ExployerName.y],
names_from = AssmntYr,
values_from = EmployerName.y)
pivot_wider(gpd_uni[, c("AssmntYr", "ExployerName.y")],
names_from = AssmntYr,
values_from = EmployerName.y)
gpd_uni
pivot_wider(gpd_uni[, c("AssmntYr", "EmployerName.y")],
names_from = AssmntYr,
values_from = EmployerName.y)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr))
gpd_yr <- gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr))
?summarise
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
arrange(EmployerName.y, desc(AssmntYr))
pivot_wider(gpd_yr,
names_from = AssmntYr,
values_from = EmployerName.y)
pivot_wider(gpd_yr,
names_from = AssmntYr,
values_from = UniCount)
head(gpd_yr)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount)
pivot_wider(names_from = AssmntYr,
values_from = UniAvailable)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
mutate(UniAvailable = UniCount == 1)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
mutate(UniAvailable = UniCount == 1)
pivot_wider(names_from = AssmntYr,
values_from = UniAvailable)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
mutate(UniAvailable = UniCount == 1) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniAvailable)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCnt) %>%
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCnt)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit()
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit() %>%
[, c(EmployerName.y)]
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit() %>%
[[, c(EmployerName.y)]]
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit() %>%
print(EmployerName.y)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit()
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit() %>%
$EmployerName.y
all_yr_uni <- gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount) %>%
na.omit()
head(all_yr_uni$EmployerName.y)
print(all_yr_uni$EmployerName.y, n=10)
all_yr_uni[, c(EmployerName.y), drop=FALSE)
all_yr_uni[, c(EmployerName.y), drop=FALSE]
all_yr_uni[, c("EmployerName.y"), drop=FALSE]
print(all_yr_uni[, c("EmployerName.y"), drop=FALSE], n=20)
gpd_uni %>%
group_by(EmployerName.y, AssmntYr) %>%
summarise("UniCount" = n()) %>%
arrange(EmployerName.y, desc(AssmntYr)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount)
head(gpd_cont)
print(gpd_cont)
print(gpd_cont, n=20)
unique(gpd_uni$EmployerSize)
gpd_uni %>%
group_by(pre92, EmployerSize, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent), mean_diffbnspct = mean(DiffMeanBonusPercent))
print(gpd_uni$DiffMeanBonusPercent, n=100)
print(gpd_uni[, "DiffMeanBonusPercent"], n=100)
gpd_uni %>%
group_by(pre92, EmployerSize, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent))
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent))
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = UniCount)
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct)
filter(gpd_uni, EmployerSize == "250 to 499" & pre92 == "yes")
filter(gpd_uni, EmployerSize == "500 to 999" & pre92 == "yes") %>%
filter(gpd_uni, EmployerSize == "500 to 999" & pre92 == "yes")
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct) %>%
mutate(rte_chg = (2022-2018)/2018)
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct) %>%
mutate(rte_chg = (`2022`-`2018`)/`2018`)
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct) %>%
mutate(rte_chg_18to22 = (`2018`-`2022`)/`2018`*100)
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct) %>%
mutate(chgpct_18to22 = (`2018`-`2022`)/`2018`*100)
# -------*--------
# Shows the trend for the Differen in Mean Hourly Rates from 2017-18 to 2021-22
# split by Pre and Post '92 unis as well as the rate of change from Y1 to Y5
gpd_uni %>%
group_by(EmployerSize, pre92, AssmntYr) %>%
summarize(mean_diffhrlypct = mean(DiffMeanHourlyPercent)) %>%
pivot_wider(names_from = AssmntYr,
values_from = mean_diffhrlypct) %>%
mutate(ChgPct18to22 = (`2018`-`2022`)/`2018`*100)
